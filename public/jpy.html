<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>엔화 투자 기록</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <nav class="nav">
        <a href="index.html">← 홈</a>
        <a href="usd.html">🇺🇸 달러</a>
        <a href="jpy.html" class="active">🇯🇵 엔화</a>
        <a href="eur.html">🇪🇺 유로</a>
    </nav>

    <main class="container">
        <!-- 현재 환율 -->
        <div class="current-rate">
            <div>
                <div class="label">현재 엔화 환율 (100엔) <span id="rateTime"
                        style="font-size: 0.8rem; color: var(--text-muted);"></span></div>
                <div class="value" id="currentRate">조회 중...</div>
            </div>
            <button class="refresh-btn" onclick="refreshRate()">🔄</button>
        </div>

        <!-- 매수 등록 -->
        <section class="section">
            <h2 class="section-title"><span class="icon">📥</span> 매수 등록</h2>
            <form id="buyForm" onsubmit="submitBuy(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>엔화 금액 (¥)</label>
                        <input type="number" id="buyAmount" step="1" placeholder="10000" required>
                    </div>
                    <div class="form-group">
                        <label>매수 환율 (₩/100¥)</label>
                        <input type="number" id="buyRate" step="0.01" placeholder="956.00" required>
                    </div>
                    <div class="form-group">
                        <label>메모</label>
                        <input type="text" id="buyMemo" placeholder="선택사항">
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="applyCurrentRate()">현재환율</button>
                    <button type="submit" class="btn btn-primary">매수</button>
                </div>
            </form>
        </section>

        <!-- 거래 내역 -->
        <section class="section">
            <div class="section-header">
                <h2 class="section-title"><span class="icon">📋</span> 거래 내역</h2>
                <button class="btn btn-secondary btn-small" onclick="exportCSV()">📊 CSV 내보내기</button>
            </div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>매수일</th>
                            <th>외화</th>
                            <th>매수환율</th>
                            <th>매수원화</th>
                            <th>매도환율</th>
                            <th>수익</th>
                            <th>상태</th>
                            <th>액션</th>
                        </tr>
                    </thead>
                    <tbody id="transactionList">
                        <tr>
                            <td colspan="9" class="empty-state">
                                <div class="loading"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- 매도 모달 -->
    <div class="modal-overlay" id="sellModal">
        <div class="modal">
            <h3>💰 매도 처리</h3>
            <input type="hidden" id="sellTransactionId">
            <div class="form-group">
                <label>매도 수량</label>
                <div id="sellAmount" style="font-size: 1.5rem; font-weight: 600; color: var(--accent-blue);"></div>
            </div>
            <div class="form-group">
                <label>매도 환율 (₩/100¥)</label>
                <input type="number" id="sellRate" step="0.01" placeholder="960.00">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeSellModal()">취소</button>
                <button class="btn btn-success" onclick="submitSell()">매도 확정</button>
            </div>
        </div>
    </div>

    <!-- 삭제 확인 모달 -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <h3>🗑️ 삭제 확인</h3>
            <input type="hidden" id="deleteTransactionId">
            <p style="margin: 20px 0; color: var(--text-secondary);">이 거래 기록을 정말 삭제하시겠습니까?</p>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeDeleteModal()">취소</button>
                <button class="btn btn-danger" onclick="confirmDelete()">삭제</button>
            </div>
        </div>
    </div>

    <!-- 토스트 -->
    <div class="toast" id="toast"></div>

    <script src="app.js"></script>
    <script>
        initCurrencyPage('JPY');
    </script>
</body>

</html>